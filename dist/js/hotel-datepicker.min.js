!function(t,e,a){"use strict";t.fn.hotelDatePicker=function(n){function r(e,n){return e.target===n||n.childNodes!==a&&t.inArray(e.target,n.childNodes)>=0}function s(){function e(e){var a=t(e).parents("table").hasClass("month2"),r=a?n.month2:n.month1;r=I(r),!G&&!a&&T(r,n.month2)>=0||F(r)||(b(r,a?"month2":"month1"),w(),C())}function a(e){var a=t(e).parents("table").hasClass("month2"),r=a?n.month2:n.month1;r=N(r),a&&T(r,n.month1)<=0||F(r)||(b(r,a?"month2":"month1"),w(),C())}var s=this,i=t(this);if(i.data("hdp-opened"))return void M();i.data("hdp-opened",!0),Q=P().hide(),Q.append('<div class="date-range-length-tip"></div>'),Q.delegate(".day","mouseleave",function(){Q.find(".date-range-length-tip").hide()}),n.container?t(n.container).append(Q):s.parent().append(Q);var d=new Date;n.startDate&&T(d,n.startDate)<0&&(d=n.startDate),n.endDate&&T(I(d),n.endDate)>0&&(d=N(n.endDate)),b(d,"month1"),b(I(d),"month2");var o="";o=A(n.minDays&&n.maxDays?"default-range":n.minDays?"default-more":"default-default"),Q.find(".default-top").html(o.replace(/\%d/,n.minDays-1).replace(/\%d/,n.maxDays-1)),G?Q.addClass("single-month"):Q.addClass("two-months"),Q.click(function(t){t.stopPropagation()}),t(document).bind("click.datepicker",function(t){r(t,s[0])||Q.is(":visible")&&M()}),Q.find(".next").click(function(){e(this)}),Q.find(".prev").click(function(){a(this)}),Q.delegate(".day","click",function(){h(t(this))}),Q.delegate(".day","mouseenter",function(){p(t(this))}),Q.attr("unselectable","on").css("user-select","none").bind("selectstart",function(t){return t.preventDefault(),!1}),Q.find(".apply-btn").click(function(){M();var e=Y(new Date(n.start))+n.separator+Y(new Date(n.end));t(s).trigger("datepicker-apply",{value:e,date1:new Date(n.start),date2:new Date(n.end)})})}function i(){return Q}function d(e){o(),Q.slideDown(e,function(){t(B).trigger("datepicker-opened",{relatedTarget:Q})}),t(B).trigger("datepicker-open",{relatedTarget:Q}),w(),C()}function o(){var t=n.getValue.call(E),e=t?t.split(n.separator):"";if(e&&e.length>=2){var a=n.format;a.match(/Do/)&&(a=a.replace(/Do/,"D"),e[0]=e[0].replace(/(\d+)(th|nd|st)/,"$1"),e[1]=e[1].replace(/(\d+)(th|nd|st)/,"$1")),q=!1,y(fecha.parse(e[0],a),fecha.parse(e[1],a)),q=!0}}function l(){n.start=!1,n.end=!1,Q.find(".day.checked").removeClass("checked"),Q.find(".day.last-date-selected").removeClass("last-date-selected"),Q.find(".day.first-date-selected").removeClass("first-date-selected"),n.setValue.call(E,""),v(),g(),w()}function h(e){if(!e.hasClass("invalid")){var a=e.attr("time");if(e.addClass("checked"),n.start&&n.end||!n.start&&!n.end?(n.start=a,n.end=!1):n.start&&(n.end=a),n.start&&n.end&&n.start>n.end){var r=n.end;n.end=n.start,n.start=r}n.start=parseInt(n.start),n.end=parseInt(n.end),m(),n.start&&!n.end&&(t(B).trigger("datepicker-first-date-selected",{date1:new Date(n.start)}),p(e)),f(a),v(),g(),w(),u()}}function c(t){if(t=parseInt(t,10),n.startDate&&x(t,n.startDate)<0)return!1;if(n.endDate&&x(t,n.endDate)>0)return!1;if(n.start&&!n.end){if(n.maxDays>0&&D(t,n.start)>n.maxDays)return!1;if(n.minDays>0&&D(t,n.start)<n.minDays)return!1;if(n.selectForward&&t<n.start)return!1}return!0}function f(){return Q.find(".day.invalid.tmp").removeClass("tmp invalid").addClass("valid"),n.start&&!n.end&&Q.find(".day.toMonth.valid").each(function(){var e=parseInt(t(this).attr("time"),10);c(e)?t(this).addClass("valid tmp").removeClass("invalid"):t(this).addClass("invalid tmp").removeClass("valid")}),!0}function p(e){var a=parseInt(e.attr("time")),r="";if(e.hasClass("has-tooltip")&&e.attr("data-tooltip"))r='<span style="white-space:nowrap">'+e.attr("data-tooltip")+"</span>";else if(!e.hasClass("invalid")&&(Q.find(".day").each(function(){var e=parseInt(t(this).attr("time"));e===a?t(this).addClass("hovering"):t(this).removeClass("hovering"),n.start&&!n.end&&(n.start<e&&a>=e||n.start>e&&e>=a)?t(this).addClass("hovering"):t(this).removeClass("hovering")}),n.start&&!n.end)){var s=D(a,n.start)-1;if(n.hoveringTooltip)if("function"==typeof n.hoveringTooltip)r=n.hoveringTooltip(s,n.start,a);else if(n.hoveringTooltip===!0&&s>0){var i=A(1===s?"night":"nights");r=s+" "+i}}if(r){var d=e.offset(),o=Q.offset(),l=d.left-o.left,h=d.top-o.top;l+=e.width()/2;var c=Q.find(".date-range-length-tip"),f=c.css({visibility:"hidden",display:"none"}).html(r).width(),p=c.height();l-=f/2,h-=p,setTimeout(function(){c.css({left:l,top:h,display:"block",visibility:"visible"})},10)}else Q.find(".date-range-length-tip").hide()}function m(){Q.find(".day.hovering").removeClass("hovering"),Q.find(".date-range-length-tip").hide()}function u(){q&&n.start&&n.end&&n.autoClose&&M()}function v(){var t=Math.ceil((n.end-n.start)/864e5)+1;n.maxDays&&t>n.maxDays?(n.start=!1,n.end=!1,Q.find(".day").removeClass("checked"),Q.find(".drp_top-bar").removeClass("normal").addClass("error").find(".error-top").html(A("less-than").replace("%d",n.maxDays-1))):n.minDays&&t<n.minDays?(n.start=!1,n.end=!1,Q.find(".day").removeClass("checked"),Q.find(".drp_top-bar").removeClass("normal").addClass("error").find(".error-top").html(A("more-than").replace("%d",n.minDays-1))):n.start||n.end?Q.find(".drp_top-bar").removeClass("error").addClass("normal"):Q.find(".drp_top-bar").removeClass("error").removeClass("normal"),n.start&&n.end?Q.find(".apply-btn").removeClass("disabled"):Q.find(".apply-btn").addClass("disabled")}function g(e,a){if(Q.find(".start-day").html("..."),Q.find(".end-day").html("..."),Q.find(".selected-days").hide(),n.start&&Q.find(".start-day").html(Y(new Date(parseInt(n.start)))),n.end&&Q.find(".end-day").html(Y(new Date(parseInt(n.end)))),n.start&&n.end){var r=D(n.end,n.start)-1,s=1===r?r+" "+A("night"):r+" "+A("nights");Q.find(".selected-days").show().find(".selected-days-num").html(s),Q.find(".apply-btn").removeClass("disabled");var i=Y(new Date(n.start))+n.separator+Y(new Date(n.end));n.setValue.call(E,i,Y(new Date(n.start)),Y(new Date(n.end))),q&&!a&&t(B).trigger("datepicker-change",{value:i,date1:new Date(n.start),date2:new Date(n.end)})}else e?Q.find(".apply-btn").removeClass("disabled"):Q.find(".apply-btn").addClass("disabled")}function D(t,e){return Math.abs(_(t)-_(e))+1}function y(t,e,a){if(t.getTime()>e.getTime()){var r=e;e=t,t=r,r=null}var s=!0;return n.startDate&&x(t,n.startDate)<0&&(s=!1),n.endDate&&x(e,n.endDate)>0&&(s=!1),s?(n.start=t.getTime(),n.end=e.getTime(),x(t,e)>0&&0===T(t,e)&&(e=I(t)),0===T(t,e)&&(e=I(t)),b(t,"month1"),b(e,"month2"),w(),C(),v(),g(!1,a),void u()):(b(n.startDate,"month1"),b(I(n.startDate),"month2"),w(),void C())}function w(){(n.start||n.end)&&Q.find(".day").each(function(){var e=parseInt(t(this).attr("time")),a=n.start,r=n.end;n.start&&n.end&&r>=e&&e>=a||n.start&&!n.end&&fecha.format(a,"YYYY-MM-DD")===fecha.format(e,"YYYY-MM-DD")?t(this).addClass("checked"):t(this).removeClass("checked"),n.start&&fecha.format(a,"YYYY-MM-DD")===fecha.format(e,"YYYY-MM-DD")?t(this).addClass("first-date-selected"):t(this).removeClass("first-date-selected"),n.end&&fecha.format(r,"YYYY-MM-DD")===fecha.format(e,"YYYY-MM-DD")?t(this).addClass("last-date-selected"):t(this).removeClass("last-date-selected")})}function b(t,e){var a=k(t.getMonth());Q.find("."+e+" .month-name").html(a+" "+t.getFullYear()),Q.find("."+e+" tbody").html(z(t)),n[e]=t,f()}function k(t){return A("month-name")[t]}function Y(t){return fecha.format(t,n.format)}function C(){var t=parseInt(fecha.format(n.month1,"YYYYMM")),e=parseInt(fecha.format(n.month2,"YYYYMM")),a=Math.abs(t-e),r=a>1&&89!==a;r?Q.removeClass("no-prev-next"):Q.addClass("no-prev-next")}function M(){t(Q).slideUp(n.duration,function(){t(B).data("hdp-opened",!1),t(B).trigger("datepicker-closed",{relatedTarget:Q})}),t(B).trigger("datepicker-close",{relatedTarget:Q})}function T(t,e){var a=parseInt(fecha.format(t,"YYYYMM"))-parseInt(fecha.format(e,"YYYYMM"));return a>0?1:0===a?0:-1}function x(t,e){var a=parseInt(fecha.format(t,"YYYYMMDD"))-parseInt(fecha.format(e,"YYYYMMDD"));return a>0?1:0===a?0:-1}function I(t){var e=new Date(t.valueOf());return new Date(e.setMonth(e.getMonth()+1))}function N(t){var e=new Date(t.valueOf());return new Date(e.setMonth(e.getMonth()-1))}function P(){var e='<div class="hdp-wrapper';return n.extraClass&&(e+=" "+n.extraClass+" "),n.showTopbar||(e+=" no-topbar "),e+='">',n.showTopbar&&(e+='<div class="drp_top-bar">',e+='<div class="normal-top"><span>'+A("selected")+' </span> <strong class="start-day">...</strong>',e+=' <span class="separator-day">'+n.separator+'</span> <strong class="end-day">...</strong> <em class="selected-days">(<span class="selected-days-num">3</span>)</em>',e+="</div>",e+='<div class="error-top">error</div><div class="default-top">default</div>',e+='<input type="button" class="apply-btn disabled hide" value="'+A("apply")+'" />',e+="</div>"),e+='<div class="month-wrapper"><table class="month1" cellspacing="0" border="0" cellpadding="0"><thead><tr class="caption"><th><span class="prev">&lt;</span></th><th colspan="5" class="month-name"></th><th><span class="next">&gt;</span></th></tr><tr class="week-name">'+O()+"</thead><tbody></tbody></table>",j()&&(e+='<table class="month2" cellspacing="0" border="0" cellpadding="0"><thead><tr class="caption"><th><span class="prev">&lt;</span></th><th colspan="5" class="month-name"></th><th><span class="next">&gt;</span></th></tr><tr class="week-name">'+O()+"</thead><tbody></tbody></table>"),e+='<div style="clear:both;height:0;font-size:0;"></div>',e+="</div>",e+="</div>",t(e)}function O(){return"monday"===n.startOfWeek?"<th>"+A("week-1")+"</th><th>"+A("week-2")+"</th><th>"+A("week-3")+"</th><th>"+A("week-4")+"</th><th>"+A("week-5")+"</th><th>"+A("week-6")+"</th><th>"+A("week-7")+"</th>":"<th>"+A("week-7")+"</th><th>"+A("week-1")+"</th><th>"+A("week-2")+"</th><th>"+A("week-3")+"</th><th>"+A("week-4")+"</th><th>"+A("week-5")+"</th><th>"+A("week-6")+"</th>"}function F(t){var e=new Date(t.valueOf());return n.startDate&&new Date(e.getFullYear(),e.getMonth()+1,0,23,59,59)<n.startDate?!0:n.endDate&&new Date(e.getFullYear(),e.getMonth(),1)>n.endDate?!0:!1}function j(){return!G}function V(t){var e=t,a="";for(var n in t)e.hasOwnProperty(n)&&(a+=n+'="'+e[n]+'" ');return a}function _(t){return Math.floor(W(t)/864e5)}function W(t){return"object"==typeof t&&t.getTime&&(t=t.getTime()),"string"!=typeof t||t.match(/\d{13}/)||(t=fecha.parse(t,n.format).getTime()),t=parseInt(t,10)-60*(new Date).getTimezoneOffset()*1e3}function R(t,e){var a=new Date(t);return a.setDate(a.getDate()+e),a}function z(t){var e=[];t.setDate(1);var a,r=t.getDay();if(0===r&&"monday"===n.startOfWeek&&(r=7),r>0)for(var s=r;s>0;s--){var i=new Date(t.getTime()-864e5*s);a=c(i.getTime()),n.startDate&&x(i,n.startDate)<0&&(a=!1),n.endDate&&x(i,n.endDate)>0&&(a=!1),e.push({date:i,type:"lastMonth",day:i.getDate(),time:i.getTime(),valid:a})}for(var d=t.getMonth(),o=0;40>o;o++){var l=R(t,o);a=c(l.getTime()),n.startDate&&x(l,n.startDate)<0&&(a=!1),n.endDate&&x(l,n.endDate)>0&&(a=!1),e.push({date:l,type:l.getMonth()===d?"toMonth":"nextMonth",day:l.getDate(),time:l.getTime(),valid:a})}for(var h=[],f=0;6>f&&"nextMonth"!==e[7*f].type;f++){h.push("<tr>");for(var p=0;7>p;p++){var m="monday"===n.startOfWeek?p+1:p,u=e[7*f+m],v=fecha.format(u.time,n.format)===fecha.format(new Date,n.format);u.extraClass="",u.tooltip="";var g={time:u.time,"data-tooltip":u.tooltip,"class":"day "+u.type+" "+u.extraClass+" "+(u.valid?"valid":"invalid")+" "+(v?"real-today":"")};h.push("<td><div "+V(g)+">"+$(u.time,u.day)+"</div></td>")}h.push("</tr>")}return h.join("")}function $(t,e){return n.showDateFilter&&"function"==typeof n.showDateFilter?n.showDateFilter(t,e):e}function A(t){return t in n.i18n?n.i18n[t]:""}n||(n={}),n=t.extend(!0,{format:"YYYY-MM-DD",separator:" - ",startOfWeek:"sunday",getValue:function(){return t(this).val()},setValue:function(e){t(this).attr("readonly")||t(this).is(":disabled")||e===t(this).val()||t(this).val(e)},startDate:new Date,endDate:!1,minNights:1,maxNights:0,selectForward:!1,container:"",duration:200,hoveringTooltip:!0,showTopbar:!0,i18n:{selected:"Your stay:",night:"Night",nights:"Nights",apply:"Close","week-1":"mo","week-2":"tu","week-3":"we","week-4":"th","week-5":"fr","week-6":"sa","week-7":"su","month-name":["january","february","march","april","may","june","july","august","september","october","november","december"],"less-than":"Date range should not be more than %d night(s)","more-than":"Date range should not be less than %d night(s)","default-more":"Please select a date range longer than %d night(s)","default-range":"Please select a date range between %d and %d night(s)","default-default":"Please select a date range"}},n),n.start=!1,n.end=!1,n.minDays=n.minNights>1?n.minNights+1:2,n.maxDays=n.maxNights>1?n.maxNights+1:0,n.startDate&&"string"==typeof n.startDate&&(n.startDate=fecha.parse(n.startDate,n.format)),n.endDate&&"string"==typeof n.endDate&&(n.endDate=fecha.parse(n.endDate,n.format));var Q,U,q=!1,B=this,E=t(B).get(0),G=t(e).width()<480,H="ontouchstart"in e||navigator.msMaxTouchPoints;return G=t(e).width()<480,H&&(n.hoveringTooltip=!1),t(this).unbind(".datepicker").bind("click.datepicker",function(){var t=Q.is(":visible");t||d(n.duration)}).bind("change.datepicker",function(){o()}).bind("keyup.datepicker",function(){try{clearTimeout(U)}catch(t){}U=setTimeout(function(){o()},2e3)}),s.call(this),t(this).data("dateRangePicker",{setDateRange:function(t,e,a){"string"==typeof t&&"string"==typeof e&&(t=fecha.parse(t,n.format),e=fecha.parse(e,n.format)),y(t,e,a)},clear:l,close:M,open:d,getDatePicker:i,destroy:function(){t(B).unbind(".datepicker"),t(B).data("dateRangePicker",""),t(B).data("hdp-opened",null),Q.remove(),t(document).unbind("click.datepicker",M)}}),this}}(jQuery,window);